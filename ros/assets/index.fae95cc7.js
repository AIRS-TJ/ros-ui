var $e=Object.defineProperty,Ce=Object.defineProperties;var Se=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Fe=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var X=(e,t,s)=>t in e?$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,D=(e,t)=>{for(var s in t||(t={}))Fe.call(t,s)&&X(e,s,t[s]);if(oe)for(var s of oe(t))Me.call(t,s)&&X(e,s,t[s]);return e},E=(e,t)=>Ce(e,Se(t));var C=(e,t,s)=>(X(e,typeof t!="symbol"?t+"":t,s),s);import{d as b,c as n,r as d,a as B,b as A,e as r,u as ae,m as ke,o as g,f as ne,n as ie,g as N,h as Y,t as I,w as v,i as M,j as T,D as Be,P as Te,k as De,l as re,p as Ee,q as W,F as L,E as Oe,s as Re,v as Q,x as Ne,M as le,y as z,z as P,A as Ie,B as Le,C as ze,U as ue,R as ce,G as Pe,H as Ue,I as Ve,J as U,K as V,S as He,L as xe,N as je,O as x,Q as de,T as K,V as q,W as Ge,X as Xe,Y as Ye,Z as We,_ as Qe,$ as Ke,a0 as qe}from"./vendor.dff09cba.js";const Ze=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=s(o);fetch(o.href,i)}};Ze();var Je=b({setup(){return()=>n(d("router-view"),null,null)}});const et=["xlink:href"],pe=b({props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const t=e,s=B(()=>`#icon-${t.name}`),a=B(()=>t.name?`svg-icon icon-${t.name}`:"svg-icon");return(o,i)=>(g(),A("svg",ke({class:ae(a)},o.$attrs,{style:{color:e.color}}),[r("use",{"xlink:href":ae(s)},null,8,et)],16))}}),j=ne("app",{state:()=>({collapsed:!1,showLoadPap:!1,isCreatingNewMap:!1})}),tt=function(e){var t=e.w,s=e.x,a=e.y,o=e.z,i=-Math.atan2(2*(t*o+s*a),1-2*(a*a+o*o))*180/Math.PI;return i};class st{constructor(t){C(this,"stations");C(this,"id");C(this,"ros");this.ros=t,this.stations=[],this.id=0,window.__station=this}addStation(t){t.stationId=++this.id}reset(){this.stations=[],this.id=0}send(){let t=new window.ROSLIB.Topic({ros:this.ros,name:"/cmd_vel",messageType:"geometry_msgs/Twist"}),s=new window.ROSLIB.Message(this.stations);t.publish(s)}}const Z=ne("system",{state:()=>({exclusiveState:!0,schedulingMode:!0,lowPowerConsumption:!0,volume:50,step:.1}),getters:{sortedList:e=>e}});let J=null;const ot="socket-notification";class at{constructor(){C(this,"ros");C(this,"cmdVel");C(this,"twist");C(this,"gridClient");C(this,"viewer");C(this,"connected",!1);C(this,"nav");C(this,"robot");C(this,"robotAdd");C(this,"isMoving");C(this,"pose");C(this,"robotMarker");this.ros=new window.ROSLIB.Ros({groovyCompatibility:!0}),this.cmdVel=new window.ROSLIB.Topic({ros:this.ros,name:"/cmd_vel",messageType:"geometry_msgs/Twist"}),this.twist=new window.ROSLIB.Message({linear:{x:0,y:0,z:0},angular:{x:0,y:0,z:0}}),this.ros.on("error",t=>{console.log(t),ie.error({key:ot,message:"ros error"})}),this.ros.on("connection",()=>{this.connected=!0,this.displayRobot(!0)}),window.ros=this,this.robotAdd=!1,this.robot=this.createRobot(),J=this.ros,this.init()}init(){new st(this.ros),this.isMoving=!1}connect(t){this.ros.connect(t)}goRotate(t){this.twist.angular.z+=t,this.cmdVel.publish(this.twist)}go(t){const s=Z(),a=B(()=>s.$state.step);switch(t){case"forward":this.twist.linear.x+=a.value;break;case"back":this.twist.linear.x-=a.value;break;case"right":this.twist.angular.z-=a.value;break;case"left":this.twist.angular.z+=a.value;break}this.cmdVel.publish(this.twist)}stop(){this.twist.linear.x=0,this.twist.linear.y=0,this.twist.linear.z=0,this.twist.angular.x=0,this.twist.angular.y=0,this.twist.angular.z=0,this.cmdVel.publish(this.twist)}initMap({divID:t,width:s,height:a}){this.viewer=new window.ROS2D.Viewer({divID:t,width:s,height:a}),this.nav=window.NAV2D.OccupancyGridClientNav({ros:this.ros,rootObject:this.viewer.scene,viewer:this.viewer,serverName:"/move_base",continuous:!0,withOrientation:!0})}resizeMap(){try{this.gridClient&&this.gridClient.currentGrid&&this.viewer.scaleToDimensions(this.gridClient.currentGrid.width,this.gridClient.currentGrid.height),this.gridClient&&this.gridClient.currentGrid&&this.gridClient.currentGrid.pose&&this.viewer.shift(this.gridClient.currentGrid.pose.position.x,this.gridClient.currentGrid.pose.position.y)}catch(t){console.warn("[resize map error]: ",t)}}createRobot(){const t=new window.createjs.Shape;return t.graphics.beginFill("#F6AB00").drawCircle(0,0,6),t.alpha=.6,t}displayRobot(t=!1){let s=0,a=0;const o=this.viewer.scene;this.robotMarker&&o.removeChild(this.robotMarker);const i=new window.ROS2D.NavigationArrow({size:t?25:.25,strokeSize:t?5:.05,pulse:!0,fillColor:"#F6AB00",strokeColor:"#F6AB00"});o.addChild(i),this.robotMarker=i,t&&(i.x=this.viewer.width/2-12.5,i.y=-(this.viewer.height/2-12.5)),console.log(i),window.robotMarker=i;var l=new window.ROSLIB.Topic({ros:this.ros,name:"/tracked_pose",throttle_rate:100});l.subscribe(u=>{this.pose=u;const p=u.pose.position.x,h=-u.pose.position.y;s===p&&a===h?this.isMoving=!1:(this.isMoving=!0,s=p,a=h,i.x=u.pose.position.x,i.y=-u.pose.position.y,i.rotation=tt(u.pose.orientation))}),_e(this.viewer.scene,i,u=>{console.log("rotation",u),this.sendRotation(u)},{fromConnect:!0})}sendRotation(t){const s=new window.ROSLIB.Message({linear:{x:0,y:0,z:0},angular:{x:0,y:0,z:t}});new window.ROSLIB.Topic({ros:this.ros,name:"/cmd_vel",messageType:"geometry_msgs/Twist"}).publish(s)}}var $=new at;function nt(e,t,s){var a=t[0]-e[0],o=e[1]-t[1],i=s[0]-e[0],l=e[1]-s[1],u=Math.sqrt(a*a+o*o)*Math.sqrt(i*i+l*l);if(u==0)return-1;var p=Math.acos((a*i+o*l)/u);if(e[0]-s[0]<0&&e[1]-s[1]<0)return p;if(e[0]-s[0]<0&&e[1]-s[1]>0)return p;if(e[0]-s[0]>0&&e[1]-s[1]<0)return 2*Math.PI-p;if(e[0]-s[0]>0&&e[1]-s[1]>0)return 2*Math.PI-p}let ee,me;function it(e,t){var s=e.globalToRos(t.stageX,t.stageY),a=new window.ROSLIB.Vector3(s);const o=a.x-ee.x,i=a.y-ee.y;let l=Math.atan2(o,i);l>=0&&l<=Math.PI?l+=3*Math.PI/2:l-=Math.PI/2;var u=Math.sin(-l/2);return u}const _e=(e,t,s,a={})=>{const{createjs:o}=window;e.canvas.getBoundingClientRect();function i(p,h,m,w){h=.002/e.scale,a.fromConnect&&(h=120),p.graphics.clear().ss(3).s("#503183").mt(0,0);for(var y=15,c=0,S=(h-y)/m;c<S;c++){var _=m/4,f=!1,k=w;if(k=Math.pow(w,.5/S)*c,c*m+_*2>h-y&&(_=(h-y*1.5-c*m)/2,f=!0),p.graphics.qt(c*m+_,k,c*m+_*2,0),f)break;c*m+_*4>h-y&&(_=(h-y*1.5-c*m)/4),p.graphics.qt(c*m+_*3,-k,c*m+_*4,0)}p.graphics.f("#503183"),p.graphics.dp(h-y,0,y,3)}var l=null,u=null;t.on("mousedown",function(p){l=new o.Shape().set({x:t.x,y:t.y}),u=new o.Shape().set({x:t.x,y:t.y}),l.scale=.01,u.scale=e.scale,e.addChild(l),e.addChild(u),window.arrow=l,me=e.globalToRos(p.stageX,p.stageY),ee=new window.ROSLIB.Vector3(me);var h=e.on("stagemousemove",function(w){var y=e.mouseX-(t.x+e.x),c=e.mouseY-(t.y+e.y),S=Math.sqrt(y*y+c*c);i(l,S,Math.sqrt(S),0);const _=e.scale;nt([t.x/_,t.y/_],[p.stageX,p.stageY],[e.mouseX/_,e.mouseY/_]),l.rotation=Math.atan2(c,y)*180/Math.PI,e.update()}),m=e.on("stagemouseup",function(w){e.off("stagemousemove",h),e.off("stagemouseup",m);const y=it(e,w);s(y),e.removeChild(l),e.update(),l=null})})},O=e=>{console.log("create topic:",e);const t=new window.ROSLIB.Topic({ros:J,name:"/chatter",messageType:"std_msgs/String"}),s=new window.ROSLIB.Message({data:e});return t.publish(s),t};var F=(e,t)=>{const s=e.__vccOpts||e;for(const[a,o]of t)s[a]=o;return s};const rt=b({setup(){const e=j(),t=N({keywords:"",mapDataSource:[],mapDataColumns:[{title:"\u5730\u56FE\u540D\u79F0",dataIndex:"name",key:"name",slots:{customRender:"name"}},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updateTime",key:"updateTime",defaultSortOrder:"descend",sorter:(i,l)=>new Date(i.updateTime).getTime()-new Date(l.updateTime).getTime()},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",defaultSortOrder:"descend",sorter:(i,l)=>new Date(i.createTime).getTime()-new Date(l.createTime).getTime()},{dataIndex:"action",key:"action",width:150,slots:{title:"customTitle",customRender:"action"}}]}),s=i=>{t.keywords=i},a=()=>{O("map_list").subscribe(({data:i})=>{const u=(i.split("#")[1]||"").split(" ").map((p,h)=>({key:`${h}`,name:p,createTime:"",updateTime:""}));t.mapDataSource=u})},o=()=>{e.$patch({isCreatingNewMap:!0}),O("new_map").subscribe(i=>{console.log("onCreateMap",i)})};return Y(()=>{a()}),E(D({},I(t)),{onSearch:s,onCreateMap:o,showMapList:a})}}),lt={class:"map-list-con dashboard"},ut={class:"action-header"},ct=M(" \u65B0\u5EFA\u5730\u56FE "),dt=M(" \u5BFC\u5165\u5730\u56FE "),pt=["src"];function mt(e,t,s,a,o,i){const l=d("PlusOutlined"),u=d("a-button"),p=d("a-input-search"),h=d("a-table");return g(),A("div",lt,[r("div",ut,[n(u,{onClick:e.onCreateMap,size:"small",class:"ros-btn-primary",type:"primary"},{icon:v(()=>[n(l)]),default:v(()=>[ct]),_:1},8,["onClick"]),n(u,{onClick:e.showMapList,size:"small",class:"ros-btn",style:{"margin-left":"20px"}},{icon:v(()=>[n(l)]),default:v(()=>[dt]),_:1},8,["onClick"]),n(p,{class:"search",value:e.keywords,"onUpdate:value":t[0]||(t[0]=m=>e.keywords=m),placeholder:"\u641C\u7D22\u5730\u56FE",style:{width:"200px","align-self":"flex-end"},onSearch:e.onSearch},null,8,["value","onSearch"])]),n(h,{dataSource:e.mapDataSource,columns:e.mapDataColumns},{name:v(({record:m})=>[r("span",null,[r("img",{src:m.img},null,8,pt),M(" "+T(m.name),1)])]),_:1},8,["dataSource","columns"])])}var _t=F(rt,[["render",mt]]);const ht=[{name:"\u4E3B\u754C\u9762",link:"main",children:[]},{name:"\u5730\u56FE\u5217\u8868",link:"maplist",children:[]},{name:"\u4EFB\u52A1",link:"task",children:[{name:"\u4EFB\u52A1\u5217\u8868",link:"taskList"},{name:"\u4EFB\u52A1\u6A21\u677F",link:"taskTemplate"},{name:"\u4EFB\u52A1\u8BA1\u5212",link:"taskPlan"}]},{name:"\u7CFB\u7EDF",link:"system",children:[{name:"\u7CFB\u7EDF\u8BBE\u7F6E",link:"sysSetting"}]},{name:"\u8C03\u8BD5",link:"debug",children:[]},{name:"\u5173\u4E8E\u6211\u4EEC",link:"about",children:[]}];var vt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABsSURBVHgB7ZRBDsAgCAS3jQ/xaX6LGz8rT2k5lkAk0kOTdm6uunFF2YjoANBRR5oajTFQhZn7jgd5r1nzxCv/bax36mmW8GS62G7wtJTZCi2asLEibWrmRcm8xb8AnNKmZqsF+NBHF21sqCMnng8r4JW+XyUAAAAASUVORK5CYII=",ft="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABbSURBVHgB7dQxCoAwDIXhPxrwGj2RJ3XyQvYUgoNUs3bREAeh/cZSHuRBIvvCRiERJWS1oHE+iDrXKQ186L9hWj/cs/NW3bU+ffDonfn1zvxaWXQpZDtsBFnOBYSKG2pQY1caAAAAAElFTkSuQmCC";const wt=async(e,t)=>(console.log("_rule",e,"value",t),/^[\u4e00-\u9fa5]/.test(t)?Promise.reject("\u5730\u56FE\u540D\u79F0\u4E0D\u80FD\u4F7F\u7528\u4E2D\u6587"):Promise.resolve()),gt=b({components:{DownloadOutlined:Be,PlusOutlined:Te,DownOutlined:De},setup(){const e=N({mapDataSource:[],mapDataColumns:[{title:"\u5730\u56FE\u540D\u79F0",dataIndex:"name",key:"name",slots:{customRender:"name"}},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updateTime",key:"updateTime",defaultSortOrder:"descend",sorter:(c,S)=>new Date(c.updateTime).getTime()-new Date(S.updateTime).getTime()},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",key:"createTime",defaultSortOrder:"descend",sorter:(c,S)=>new Date(c.createTime).getTime()-new Date(S.createTime).getTime()},{dataIndex:"action",key:"action",width:150,slots:{title:"customTitle",customRender:"action"}}],mapFileSearchKeywords:"",mapFileViewType:"list",showMapNameDialog:!1,mapNameFormState:{newMapName:""},rules:{newMapName:[{required:!0,validator:wt,trigger:"input"}]}}),t=j(),s=B(()=>t.$state.showLoadPap),a=B(()=>t.$state.isCreatingNewMap),o=()=>{O("map_list").subscribe(({data:c})=>{const _=(c.split("#")[1]||"").split(" ").map((f,k)=>({key:`${k}`,name:f,createTime:"",updateTime:""}));e.mapDataSource=_})};re(s,c=>{c&&o()});const i=c=>{t.$patch({showLoadPap:c})},l=()=>{},u=c=>{e.mapFileViewType=c},p=()=>{ie.open({message:"\u8BF7\u9065\u63A7\u673A\u5668\u4EBA\u8FDB\u884C\u5EFA\u56FE",icon:Ee(Oe,{style:"color: #f5222d"})}),t.$patch({isCreatingNewMap:!0}),O("new_map").subscribe(c=>{console.log("onCreateMap",c)})},h=()=>{e.showMapNameDialog=!0,e.mapNameFormState.newMapName=""},m=()=>{O(`save_map#${e.mapNameFormState.newMapName}`).subscribe(c=>{console.log("onSaveMap",c)}),e.showMapNameDialog=!1,t.$patch({isCreatingNewMap:!1})},w=()=>{e.mapNameFormState.newMapName="",t.$patch({isCreatingNewMap:!1}),O("new_map_quit").subscribe(c=>{console.log("new_map_quit data is: ",c)})},y=()=>{$.stop()};return E(D({},I(e)),{showLoadPap:s,isCreatingNewMap:a,onSearchMapFile:l,toggleMopFileView:u,onCreateMap:p,onMapListVisibleChange:i,onSaveMap:h,onQuitMap:w,doSaveMap:m,emergencyStop:y})}}),At={class:"header-con"},yt={class:"left-layout"},bt=M(" \u52A0\u8F7D\u5730\u56FE "),$t=M(" \u65B0\u5EFA\u5730\u56FE "),Ct={key:0,class:"create-map-action"},St=M("\u4FDD\u5B58"),Ft=M("\u9000\u51FA"),Mt={class:"map-name"},kt={class:"right-layout"},Bt=M("\u6025\u505C"),Tt=r("div",{class:"info-icon"},null,-1),Dt=r("span",{style:{"margin-left":"24px","margin-right":"8px","font-size":"16px"}},"admin",-1),Et=["src"],Ot={key:1,class:"card-view"},Rt=r("div",{class:"sort-action"},"\u66F4\u65B0\u65F6\u95F4",-1),Nt={class:"card-view-list"},It={class:"map-name-input"},Lt={class:"map-name-count"};function zt(e,t,s,a,o,i){const l=d("DownloadOutlined"),u=d("a-button"),p=d("PlusOutlined"),h=d("DownOutlined"),m=d("a-input-search"),w=d("a-table"),y=d("a-modal"),c=d("a-input"),S=d("a-form-item"),_=d("a-form");return g(),A(L,null,[r("div",At,[r("div",yt,[n(u,{onClick:t[0]||(t[0]=f=>e.onMapListVisibleChange(!0)),type:"primary",size:"small",class:"ros-btn-primary",style:{"margin-left":"10px"}},{icon:v(()=>[n(l)]),default:v(()=>[bt]),_:1}),n(u,{onClick:e.onCreateMap,size:"small",class:"ros-btn-primary",type:"primary",style:{"margin-left":"20px"}},{icon:v(()=>[n(p)]),default:v(()=>[$t]),_:1},8,["onClick"]),e.isCreatingNewMap?(g(),A("div",Ct,[n(u,{onClick:e.onSaveMap,type:"primary",size:"small",class:"ros-btn-primary",style:{"margin-left":"10px"}},{default:v(()=>[St]),_:1},8,["onClick"]),n(u,{onClick:e.onQuitMap,type:"primary",size:"small",class:"ros-btn-primary",style:{"margin-left":"20px"}},{default:v(()=>[Ft]),_:1},8,["onClick"]),r("span",Mt,T(e.mapNameFormState.newMapName),1)])):W("",!0)]),r("div",kt,[n(u,{class:"emergency-stop",size:"small",onClick:e.emergencyStop},{default:v(()=>[Bt]),_:1},8,["onClick"]),Tt,Dt,n(h,{style:{"font-size":"12px"}})])]),n(y,{visible:e.showLoadPap,onCancel:t[4]||(t[4]=f=>e.onMapListVisibleChange(!1)),title:"\u52A0\u8F7D\u5730\u56FE",width:"1000px",footer:null},{default:v(()=>[n(m,{value:e.mapFileSearchKeywords,"onUpdate:value":t[1]||(t[1]=f=>e.mapFileSearchKeywords=f),placeholder:"\u5730\u56FE\u540D\u79F0",style:{width:"200px","margin-bottom":"20px"},onSearch:e.onSearchMapFile},null,8,["value","onSearch"]),e.mapFileViewType==="list"?(g(),Re(w,{key:0,dataSource:e.mapDataSource,columns:e.mapDataColumns},{customTitle:v(()=>[r("img",{class:"list-icon__card",src:vt,style:{cursor:"pointer"},onClick:t[2]||(t[2]=f=>e.toggleMopFileView("card"))}),r("img",{class:"list-icon",src:ft,style:{"margin-left":"5px",cursor:"pointer"},onClick:t[3]||(t[3]=f=>e.toggleMopFileView("list"))})]),name:v(({record:f})=>[r("span",null,[r("img",{src:f.img},null,8,Et),M(" "+T(f.name),1)])]),_:1},8,["dataSource","columns"])):W("",!0),e.mapFileViewType==="card"?(g(),A("div",Ot,[Rt,r("div",Nt,[(g(!0),A(L,null,Q(e.mapDataSource,f=>(g(),A("div",{class:"card-item",key:f.key},[r("p",null,T(f.name),1),r("p",null,T(f.updateTime),1)]))),128))])])):W("",!0)]),_:1},8,["visible"]),n(y,{visible:e.showMapNameDialog,"onUpdate:visible":t[6]||(t[6]=f=>e.showMapNameDialog=f),title:"\u4FDD\u5B58\u5730\u56FE",onOk:e.doSaveMap,okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"},{default:v(()=>[r("div",It,[n(_,{model:e.mapNameFormState,rules:e.rules},{default:v(()=>[n(S,{"has-feedback":"",label:"\u5730\u56FE\u540D\u79F0"},{default:v(()=>[n(c,{value:e.mapNameFormState.newMapName,"onUpdate:value":t[5]||(t[5]=f=>e.mapNameFormState.newMapName=f),name:"newMapName",maxlength:20},null,8,["value"])]),_:1})]),_:1},8,["model","rules"]),r("span",Lt,T(e.mapNameFormState.newMapName.length)+" / 20",1)])]),_:1},8,["visible","onOk"])],64)}var he=F(gt,[["render",zt]]);function Pt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ie(e)}var Ut=b({components:{HomeHeader:he},setup(){const e=Ne();j();const t=s=>{e.push("/dashboard/"+s.key)};return()=>{let s;return n(d("a-layout"),{id:"layout"},{default:()=>[n(d("a-layout-sider"),{width:"140",className:"side-menu"},{default:()=>[n("div",{class:"logo"},[n(pe,{name:"aris-logo",class:"logo-icon"},null)]),n(d("a-menu"),{mode:"inline",defaultSelectedKeys:["/"],style:{height:"calc(100% - 60px)",borderRight:0},onClick:t},Pt(s=ht.map(a=>{const o=a.children.length?le.SubMenu:le.Item,i={title:()=>n("span",null,[a.name])};return n(o,{key:a.link},D({default:()=>[z(n("span",null,[a.name]),[[P,!a.children.length]]),a.children&&a.children.map(l=>n(d("a-menu-item"),{key:l.link},{default:()=>[l.name]}))]},i))}))?s:{default:()=>[s]})]}),n(d("a-layout"),null,{default:()=>[n(d("a-layout-header"),{className:"layout-header"},{default:()=>[n(he,null,null)]}),n(d("a-layout"),null,{default:()=>[n(d("a-layout-content"),{className:"main-content"},{default:()=>[n(d("router-view"),null,null)]})]})]})]})}}});const H=new window.createjs.Shape;let te=!1;const Vt=()=>{console.log("useStation"),H.graphics.beginFill("#f52d7a").drawCircle(0,0,10);const e=$.viewer.scene;e.on("mousedown",t=>{console.log(t),$.viewer.scene.addChild(H),H.setTransform(t.stageX,t.stageY),te=!0}),e.on("pressmove",t=>{console.log("mousemove",t),!!te&&H.setTransform(t.stageX,t.stageY)}),e.on("pressup",t=>{console.log("mousemove",t),!!te&&H.setTransform(t.stageX,t.stageY)})};const Ht=b({components:{PlusCircleOutlined:Le,MinusCircleOutlined:ze,UndoOutlined:ue,RedoOutlined:ce,AimOutlined:Pe,ReloadOutlined:Ue,ClearOutlined:Ve},setup(e,{emit:t}){let s;return{zoomIn:()=>{s=new window.ROS2D.ZoomView({rootObject:$.viewer.scene}),s.zoom(.9)},zoomOut:()=>{$.viewer.scaleToDimensions($.gridClient.currentGrid.width*.1,$.gridClient.currentGrid.height*.1)},rotateLeft:()=>{},rotateRight:()=>{},locate:()=>{},clear:()=>{}}}}),xt={class:"map-actions"};function jt(e,t,s,a,o,i){const l=d("PlusCircleOutlined"),u=d("MinusCircleOutlined"),p=d("ReloadOutlined");return g(),A("ul",xt,[r("li",{class:"action-item",onClick:t[0]||(t[0]=h=>e.$emit("action","zoom-in"))},[n(l)]),r("li",{class:"action-item",onClick:t[1]||(t[1]=h=>e.$emit("action","zoom-out"))},[n(u)]),r("li",{class:"action-item",onClick:t[2]||(t[2]=h=>e.$emit("action","rotate-right"))},[n(p)]),r("li",{class:"action-item dir-reverse",onClick:t[3]||(t[3]=h=>e.$emit("action","rotate-left"))},[n(p)])])}var Gt=F(Ht,[["render",jt],["__scopeId","data-v-192dd0fa"]]);const Xt=b({setup(){}}),ve=e=>(U("data-v-5da8c9c6"),e=e(),V(),e),Yt={class:"axis"},Wt=ve(()=>r("div",{class:"y"},null,-1)),Qt=ve(()=>r("div",{class:"x"},null,-1)),Kt=[Wt,Qt];function qt(e,t,s,a,o,i){return g(),A("div",Yt,Kt)}var Zt=F(Xt,[["render",qt],["__scopeId","data-v-5da8c9c6"]]);const Jt=b({setup(){}}),es={class:"home-map-bar"};function ts(e,t,s,a,o,i){return g(),A("div",es)}var ss=F(Jt,[["render",ts],["__scopeId","data-v-b6191708"]]);let fe=0,we=0;const os=e=>{new window.ROSLIB.Topic({ros:J,name:"/map",throttle_rate:100}).subscribe(function(s){const a=s.info.width*2,o=s.info.height*2;fe!==a&&we!==o&&(e({width:a,height:o}),fe=a,we=o)})};const as=[{icon:"station",name:"\u7AD9\u70B9",disable:!1,job:Vt},{icon:"area",name:"\u533A\u57DF",disable:!0},{icon:"qr-code",name:"\u4E8C\u7EF4\u7801",disable:!0}],ns=b({components:{StopOutlined:He,ArrowUpOutlined:xe,ArrowDownOutlined:je,UndoOutlined:ue,RedoOutlined:ce,HomeMapActions:Gt,HomeMapBar:ss,MapAxis:Zt},setup(){const e=Z(),t=B(()=>e.$state),s=j(),a=B(()=>s.$state.isCreatingNewMap);re(a,_=>{o.isManualControl=_});const o=N({actions:as,isManualControl:!1,activeAction:"",zoomScale:1,rotate:0,mapWidth:616,mapHeight:500}),i=x(),l=x(),u=x();Y(()=>{de(()=>{const{width:_,height:f}=i.value.getBoundingClientRect();console.log(_,f),$.initMap({divID:"map",width:_,height:f}),$.displayRobot(),os(({width:k,height:R})=>{o.mapWidth=k,o.mapHeight=R,i.value.removeChild(i.value.firstChild),$.initMap({divID:"map",width:k,height:R}),$.displayRobot(),o.zoomScale=0,o.rotate=0,h({width:k,height:R}),de(()=>{p()})}),p()})});const p=()=>{const _=1e4,f=1e4;u.value.scrollLeft=(_-u.value.offsetWidth)/2,u.value.scrollTop=(f-u.value.offsetHeight)/2},h=({width:_,height:f})=>{const k=u.value.offsetWidth/_,R=u.value.offsetHeight/f,be=Math.min(k,R);o.zoomScale=be},m=_=>{_.disable||(console.log($),o.activeAction=_.name,_.job&&_.job())},w=_=>{$.go(_)},y=_=>{switch(_){case"zoom-in":o.zoomScale<=1&&(o.zoomScale+=.1);break;case"zoom-out":o.zoomScale>=.5&&(o.zoomScale-=.1);break}},c=()=>{$.stop()},S=B(()=>({transform:`scale(${o.zoomScale}) rotate(${o.rotate}deg)`,width:o.mapWidth+"px",height:o.mapHeight+"px"}));return E(D({},I(o)),{mapEl:i,mapWrapper:u,zoomViewer:l,systemState:t,onAction:m,manualAction:w,stop:c,onMapActions:y,zoomCanvasStyle:S})}}),ge=e=>(U("data-v-551f1a7a"),e=e(),V(),e),is={class:"map-con"},rs={class:"action-list"},ls=["onClick"],us={class:"action-name"},cs={class:"map-wrapper",ref:"mapWrapper"},ds={class:"zoom-viewer",ref:"zoomViewer"},ps={class:"manual-control"},ms={class:"direction-control"},_s=ge(()=>r("div",{class:"circle circle-1"},null,-1)),hs={class:"circle circle-2"},vs={class:"speed-control"},fs=ge(()=>r("span",{style:{"margin-left":"4px"}},"m/s",-1)),ws={class:"manual-switch"},gs=M(" \u624B\u52A8\u9065\u63A7 ");function As(e,t,s,a,o,i){const l=d("SvgIcon"),u=d("StopOutlined"),p=d("a-button"),h=d("a-input-number"),m=d("a-switch"),w=d("HomeMapActions"),y=d("MapAxis");return g(),A("div",is,[r("ul",rs,[(g(!0),A(L,null,Q(e.actions,c=>(g(),A("li",{class:q(["action-item",{active:c.name===e.activeAction,disable:c.disable}]),key:c.name,onClick:S=>e.onAction(c)},[n(l,{name:c.icon,color:"#333",stroke:"#333",class:"action-svg-icon"},null,8,["name"]),r("span",us,T(c.name),1)],10,ls))),128))]),r("div",cs,[r("div",ds,[r("div",{id:"map",ref:"mapEl",style:K(e.zoomCanvasStyle)},null,4)],512)],512),r("div",ps,[z(r("div",ms,[r("div",{class:"dir-item top",onClick:t[0]||(t[0]=c=>e.manualAction("forward"))},[n(l,{name:"turn-forward",color:"#333",stroke:"#333",class:"action-svg-icon"})]),r("div",{class:"dir-item left",onClick:t[1]||(t[1]=c=>e.manualAction("left"))},[n(l,{name:"turn-left",color:"#333",stroke:"#333"})]),r("div",{class:"dir-item right",onClick:t[2]||(t[2]=c=>e.manualAction("right"))},[n(l,{name:"turn-right"})]),r("div",{class:"dir-item bottom",onClick:t[3]||(t[3]=c=>e.manualAction("back"))},[n(l,{name:"turn-back"})]),_s,r("div",hs,[n(p,{type:"primary",danger:"",shape:"circle",size:"small",class:"stop",onClick:e.stop},{icon:v(()=>[n(u)]),_:1},8,["onClick"])])],512),[[P,e.isManualControl]]),z(r("div",vs,[n(h,{class:"speed-control-input",value:e.systemState.step,"onUpdate:value":t[4]||(t[4]=c=>e.systemState.step=c),step:.1,size:"small"},null,8,["value","step"]),fs],512),[[P,e.isManualControl]]),r("div",ws,[gs,n(m,{size:"small",checked:e.isManualControl,"onUpdate:checked":t[5]||(t[5]=c=>e.isManualControl=c),style:{"margin-left":"4px"}},null,8,["checked"])])]),n(w,{onAction:e.onMapActions},null,8,["onAction"]),n(y,{style:K({transform:`rotate(${e.rotate}deg)`})},null,8,["style"])])}var ys=F(ns,[["render",As],["__scopeId","data-v-551f1a7a"]]);const bs=b({setup(){const e=localStorage.getItem("href"),t=N({href:e||"121.5.20.20:9090",rosStatus:"disconnected",battery:0}),s={GREEN:"#61C361"},a=B(()=>({backgroundColor:s.GREEN,width:`${t.battery}%`})),o=60*1e3,i=new window.ROSLIB.Topic({ros:$.ros,name:"/battery_level",messageType:"std_msgs/UInt8",throttle_rate:o});i.subscribe(function({data:u}){t.battery=u}),Ge(()=>{i.unsubscribe()});const l=()=>{localStorage.setItem("href",t.href),$.connect("ws://"+t.href)};return $.ros.on("connection",()=>{t.rosStatus="success"}),E(D({},I(t)),{onConnect:l,batteryStyle:a})}}),G=e=>(U("data-v-495cf02e"),e=e(),V(),e),$s={class:"home-panel"},Cs={class:"robot-info"},Ss={class:"header"},Fs=G(()=>r("h5",{class:"robot-title"},"\u673A\u5668\u4EBA\u5B9E\u65F6\u4FE1\u606F",-1)),Ms=M("\u673A\u5668\u4EBA\u8FDE\u63A5"),ks=G(()=>r("div",{class:"info-item"},[r("div",{class:"label"},"\u4FE1\u53F7"),r("div",{class:"info"})],-1)),Bs={class:"info-item"},Ts=G(()=>r("div",{class:"label"},"\u7535\u91CF",-1)),Ds={class:"info"},Es={class:"battery-info"},Os=Xe('<div class="info-item" data-v-495cf02e><div class="label" data-v-495cf02e>\u6E29\u5EA6</div><div class="info" data-v-495cf02e></div></div><div class="info-item" data-v-495cf02e><div class="label" data-v-495cf02e>\u9884\u8BA1\u53EF\u7528</div><div class="info" data-v-495cf02e></div></div><div class="info-item" data-v-495cf02e><div class="label" data-v-495cf02e>\u7CFB\u7EDF\u72B6\u6001</div><div class="info" data-v-495cf02e></div></div><div class="info-item" data-v-495cf02e><div class="label" data-v-495cf02e>\u5F53\u524D\u4F4D\u7F6E</div><div class="info" data-v-495cf02e></div></div>',4),Rs=G(()=>r("div",{class:"robot-map-list"},null,-1));function Ns(e,t,s,a,o,i){const l=d("a-button"),u=d("a-input");return g(),A("div",$s,[r("div",Cs,[r("div",Ss,[Fs,r("div",{class:q(["status",[e.rosStatus]])},null,2),n(l,{onClick:e.onConnect,size:"small"},{default:v(()=>[Ms]),_:1},8,["onClick"])]),n(u,{class:"ros-address",value:e.href,"onUpdate:value":t[0]||(t[0]=p=>e.href=p),size:"small",placeholder:"\u8BF7\u8F93\u5165\u94FE\u63A5"},null,8,["value"]),ks,r("div",Bs,[Ts,r("div",Ds,[r("div",Es,[r("div",{class:"battery-count",style:K(e.batteryStyle)},null,4)]),M(" "+T(e.battery)+" % ",1)])]),Os]),Rs])}var Is=F(bs,[["render",Ns],["__scopeId","data-v-495cf02e"]]);const Ls=b({components:{HomeMap:ys,HomePanel:Is},setup(){}}),zs={class:"home-con"};function Ps(e,t,s,a,o,i){const l=d("HomeMap"),u=d("HomePanel");return g(),A("div",zs,[n(l),n(u)])}var Us=F(Ls,[["render",Ps],["__scopeId","data-v-4e2211aa"]]);const Vs=b({name:"LoginForm",setup(){const e=N({tabs:[{label:"password",name:"\u5BC6\u7801\u767B\u9646"},{label:"pin",name:"PIN\u7801\u767B\u9646"}],activeTab:"password",passwordState:{account:"",password:""}}),t=s=>{e.activeTab=s};return E(D({},I(e)),{onTabChange:t})}}),Hs={class:"login-form"},xs={class:"form-tab"},js=["onClick"],Gs={class:"password-form form-layout"},Xs={class:"pin-form form-layout"};function Ys(e,t,s,a,o,i){const l=d("a-input"),u=d("a-form-item"),p=d("a-input-password"),h=d("a-form");return g(),A("div",Hs,[r("div",xs,[(g(!0),A(L,null,Q(e.tabs,m=>(g(),A("div",{class:q(["tab-item",{"active-tab":m.label===e.activeTab}]),key:m.label,onClick:w=>e.onTabChange(m.label)},T(m.name),11,js))),128))]),z(r("div",Gs,[n(h,{model:e.passwordState,layout:"vertical"},{default:v(()=>[n(u,{label:"\u624B\u673A/\u90AE\u7BB1"},{default:v(()=>[n(l,{value:e.passwordState.account,"onUpdate:value":t[0]||(t[0]=m=>e.passwordState.account=m)},null,8,["value"])]),_:1}),n(u,{label:"\u5BC6\u7801"},{default:v(()=>[n(p,{value:e.passwordState.password,"onUpdate:value":t[1]||(t[1]=m=>e.passwordState.password=m)},null,8,["value"])]),_:1})]),_:1},8,["model"])],512),[[P,e.activeTab==="password"]]),z(r("div",Xs,null,512),[[P,e.activeTab==="pin"]])])}var Ws=F(Vs,[["render",Ys],["__scopeId","data-v-5d227ef9"]]);const Qs=b({components:{LoginForm:Ws},setup(){}}),Ae=e=>(U("data-v-2f658411"),e=e(),V(),e),Ks=Ae(()=>r("header",{class:"login-header"},null,-1)),qs={class:"login-body"},Zs=Ae(()=>r("footer",{class:"login-footer"},[r("p",{class:"rights"},"\u6DF1\u5733\u5E02\u4EBA\u5DE5\u667A\u80FD\u4E0E\u673A\u5668\u4EBA\u7814\u7A76\u9662"),r("div",{class:"info"},[r("p",null,"\u7535\u8BDD: +86(0)755-23518114"),r("p",null,"\u5730\u5740: \u6DF1\u5733\u5E02\u9F99\u5C97\u533A\u5742\u7530\u8857\u9053\u96C5\u5B9D\u8DEF1\u53F7\u661F\u6CB3WORLD G2-14.15\u5C42"),r("p",null,"Copyright \xA9 2021 All Rights Reserved. CUHK(SZ) \u7CA4ICP\u590714099122-1\u53F7")])],-1));function Js(e,t,s,a,o,i){const l=d("LoginForm");return g(),A(L,null,[Ks,r("main",qs,[n(l)]),Zs],64)}var eo=F(Qs,[["render",Js],["__scopeId","data-v-2f658411"]]);const to=b({setup(){}});function so(e,t,s,a,o,i){return g(),A("h1",null,"About")}var oo=F(to,[["render",so]]);const ao=b({name:"Text",setup(){const e=x(null);return Y(()=>{const{createjs:t}=window;var s=new t.Stage("canvas");window.stage=s;var a=new window.ROS2D.NavigationArrow({size:40,strokeSize:10,pulse:!0,fillColor:"#F6AB00",strokeColor:"#F6AB00"});console.log("robotMarker",a),s.addChild(a),console.log("stage",s),s.scale=.5,a.x=220,a.y=220,s.update(),_e(s,a,o=>{console.log(o)})}),{canvas:e}}}),no={ref:"canvas",id:"canvas",width:"600",height:"600"};function io(e,t,s,a,o,i){return g(),A("canvas",no,null,512)}var ro=F(ao,[["render",io]]);const lo=b({setup(){}}),uo={class:"task-list-con dashboard"},co=r("h1",null,"task",-1),po=[co];function mo(e,t,s,a,o,i){return g(),A("div",uo,po)}var se=F(lo,[["render",mo]]);const _o=b({setup(){const e=Z(),t=B(()=>e.$state);return{onSubmit:()=>{},state:t}}}),ho=e=>(U("data-v-0984beb6"),e=e(),V(),e),vo={class:"dashboard"},fo=ho(()=>r("h4",{class:"title"},"\u7CFB\u7EDF\u8BBE\u7F6E",-1));function wo(e,t,s,a,o,i){const l=d("a-input-number"),u=d("a-form-item"),p=d("a-switch"),h=d("a-slider"),m=d("a-form");return g(),A("div",vo,[fo,n(m,{model:e.state,"label-col":{span:2},"wrapper-col":{span:14},labelAlign:"left"},{default:v(()=>[n(u,{label:"\u6BCF\u6B65\u8DDD\u79BB"},{default:v(()=>[n(l,{value:e.state.step,"onUpdate:value":t[0]||(t[0]=w=>e.state.step=w),step:.1},null,8,["value","step"])]),_:1}),n(u,{label:"\u72EC\u5360\u72B6\u6001"},{default:v(()=>[n(p,{checked:e.state.exclusiveState,"onUpdate:checked":t[1]||(t[1]=w=>e.state.exclusiveState=w)},null,8,["checked"])]),_:1}),n(u,{label:"\u8C03\u5EA6\u6A21\u5F0F"},{default:v(()=>[n(p,{checked:e.state.schedulingMode,"onUpdate:checked":t[2]||(t[2]=w=>e.state.schedulingMode=w)},null,8,["checked"])]),_:1}),n(u,{label:"\u4F4E\u529F\u8017"},{default:v(()=>[n(p,{checked:e.state.lowPowerConsumption,"onUpdate:checked":t[3]||(t[3]=w=>e.state.lowPowerConsumption=w)},null,8,["checked"])]),_:1}),n(u,{label:"\u7CFB\u7EDF\u97F3\u91CF"},{default:v(()=>[n(h,{id:"test",value:e.state.volume,"onUpdate:value":t[4]||(t[4]=w=>e.state.volume=w)},null,8,["value"])]),_:1})]),_:1},8,["model"])])}var ye=F(_o,[["render",wo],["__scopeId","data-v-0984beb6"]]);const go=[{path:"/",redirect:"/dashboard/main",meta:{title:"",needAuth:!0}},{path:"/dashboard",name:"Home",component:Ut,meta:{title:"",needAuth:!0},children:[{path:"main",name:"Main",component:Us,meta:{title:"",needAuth:!0}},{path:"maplist",name:"MapList",component:_t,meta:{title:"",needAuth:!0}},{path:"taskList",name:"TaskList",component:se,meta:{title:"",needAuth:!0}},{path:"taskTemplate",name:"taskTemplate",component:se,meta:{title:"",needAuth:!0}},{path:"taskPlan",name:"taskPlan",component:se,meta:{title:"",needAuth:!0}},{path:"sysSetting",name:"SysSetting",component:ye},{path:"debug",name:"debug",component:ye},{path:"about",name:"About",component:oo,meta:{title:"",needAuth:!0}},{path:"test",name:"Test",component:ro,meta:{title:"",needAuth:!0}}]},{path:"/login",name:"Login",component:eo,meta:{title:"",needAuth:!0}}],Ao=Ye({history:We(),routes:go,scrollBehavior:()=>({left:0,top:0})}),yo=Qe();Ke(Je).use(Ao).use(yo).use(qe).component("SvgIcon",pe).mount("#app");
